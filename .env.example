# AT Protocol AppView Environment Configuration
# Copy this file to .env and fill in your values

# ============================================
# REQUIRED: Database Configuration
# ============================================
# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
# IMPORTANT: Replace 'atproto' with your actual database name or create it first:
#   psql -U postgres -c "CREATE DATABASE atproto;"
DATABASE_URL=postgresql://postgres:password@localhost:5432/atproto

# Redis connection string for caching and metrics
# Format: redis://host:port
# Default: redis://localhost:6379
REDIS_URL=redis://localhost:6379

# ============================================
# REQUIRED: Security
# ============================================
# Secret key for JWT signing and encryption
# Generate with: openssl rand -base64 32
SESSION_SECRET=change-this-to-a-random-secret-key

# ============================================
# OPTIONAL: Firehose Configuration
# ============================================
# AT Protocol relay URL for firehose connection
# Default: wss://bsky.network
RELAY_URL=wss://bsky.network

# Historical backfill configuration (in days)
# 0 = disabled (no backfill)
# >0 = backfill X days of historical data
# WARNING: Resource-intensive! Each day of backfill can take hours and significant disk space
# Recommended: Start with 1-7 days for testing
# Default: 0 (disabled)
BACKFILL_DAYS=0

# Data retention configuration (in days)
# 0 = keep all data forever
# >0 = automatically prune posts/likes/reposts older than X days (runs daily)
# Note: User profiles and follows are never pruned (preserves social graph)
# Recommended: 30-90 days for production to manage disk usage
# Default: 0 (keep forever)
DATA_RETENTION_DAYS=0

# ============================================
# OPTIONAL: AppView Identity
# ============================================
# DID (Decentralized Identifier) for this AppView instance
# Used to sign JWTs when authenticating to external feed generators
#
# OPTIONS:
# 1. Use your domain (recommended if you have one):
#    APPVIEW_DID=did:web:yourappview.com
#    Requirements: You must own the domain and be able to host a DID document
#    
# 2. Leave blank for development/testing (uses default did:web:appview.local)
#    This works but won't be recognized by external services
#
# 3. Create a did:plc identifier (advanced):
#    Register at https://plc.directory and use the generated DID
#    APPVIEW_DID=did:plc:your-generated-id
#
# For most users: Leave this blank or use did:web:<your-domain> if you have one
APPVIEW_DID=

# ============================================
# OPTIONAL: Server Configuration
# ============================================
# Port for the application server
# Default: 5000
PORT=5000

# Node environment
# Options: development, production
NODE_ENV=production

# Database connection pool size
# Higher values support more concurrent connections
# Default: 32 (docker-compose uses 100 for production)
DB_POOL_SIZE=32

# Maximum concurrent event processing operations
# Balances throughput vs memory usage
# Default: 80
MAX_CONCURRENT_OPS=80

# ============================================
# OPTIONAL: Dashboard Authentication
# ============================================
# Password for dashboard access (leave blank for no authentication)
# Recommended: Set a strong password in production
DASHBOARD_PASSWORD=
